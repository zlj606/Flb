<!DOCTYPE html>
<html>
	<head>
		<title>投票系统</title>
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link href="css/bootstrap.min.css" rel="stylesheet">
		<link href="css/style.css" rel="stylesheet">

		<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    	<!--[if lt IE 9]>
     		<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      		<script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    	<![endif]-->
	</head>
	<body>
		<div class="container">
			<div class="col-lg-4 col-sm-4">
			</div>
		    <div class="col-lg-4 col-sm-4">		
		      <form class="form-signin" role="form">
		        <h2 class="form-signin-heading">帐号登陆</h2>
		        <input type="text" class="username form-control" placeholder="请输入手机号" required autofocus>
		        <input type="password" class="pwd form-control" placeholder="请输入密码" required>
		        <div class="row forget-pwd">
			        <span class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                    	<input type="checkbox" name="rememberMe" id="rememberMe" value="true" class="auto-login" tabindex="3">
                    	<label for="rememberMe">下次自动登录</label>
                    </span>
                    <span class="col-xs-6 col-sm-6 col-md-6 col-lg-6 forget">
                    	<a href="" tabindex="4">忘记密码</a>
                    </span>
		    	</div>
		    	<button class="btn btn-lg btn-primary btn-block login" type="button">登录</button>
		      </form>
		      <div class="row row-clear">
		    	<a class="register" role="navigation" href="register.html">如果您没有账号，请点击这里</a>
		      </div>  
		    </div>
		    <div class="col-lg-4 col-sm-4">
		    </div>
	    </div> <!-- /container -->
	    <script src="js/jquery-1.10.2.min.js"></script>
	    <script src="js/bootstrap.min.js"></script>
	    <script src="js/util.js"></script>
	    <script>
	    	$(function() {
	    		function callBack(jData) {
	    			if ("1" != jData.ret) {
	    				alert('failed');
	    				return;
	    			}
	    			//将用户标识存储到sessionStorage中
	    			sessionStorage.setItem('user_id', jData.res.uid);
					sessionStorage.setItem('display_name', jData.res.uid);
	    			if (jData.res.jump_url != '') {
	    				window.location.href = jData.res.jump_url;
	    			} else {
	    				window.location.href = "index.html";
	    			}
	    			 
	    			alert('success！');
	    		}

	    		$('.login').on('click', function() {
	    			var usrName = $('.username').val(),
	    				pwd = $('.pwd').val(),
	    				auto = $('.auto-login:checked').val() == "true"? "true" : "false";
	    			if ('' == usrName || '' == pwd) {
	    				alert("请输入账号和密码");
	    				return;
	    			}
	    			var data = {
	    				"controller" : "user",
	    				"action" : "login",
	    				"phone" : usrName,
	    				"pwd" : pwd
	    			};

	    			Util.post('index.php', data, callBack);
	    		});
	    	});
	    </script>
	</body>
</html>